{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Creo Pro",
  "scopeName": "source.pro",

  "repository": {
    "mapkey-init":{
      "begin": "^(mapkey\\s+)([^;\\s]+[^;]*?)",
      "beginCaptures": { 
        "1": { "name": "keyword.control.mapkey.name"},
        "2": { "name": "markup.bold.mapkey.keystroke"}
      },
      "end": "\\s",
      "name": "meta.mapkey.init.command"
    },
    "mapkey-definition": {
      "begin": "(@MAPKEY_LABEL|@MAPKEY_NAME)",
      "beginCaptures": {
        "1": { "name": "keyword.control.mapkey.label" }
      },
      "end": "(?<!\\\\)$",
      "name": "meta.mapkey.definition.command",
      "patterns": [
        {
          "match": "(.+)(?=\\\\$)",
          "captures": {
            "1": { "name": "markup.bold.mapkey.description.partial" }
          }
        },
        {
          "begin": "^(?:mapkey\\(continued\\)\\s*)?",
          "while": "^(?:mapkey\\(continued\\)\\s*)?.*\\\\$",
          "end": ";",
          "patterns": [
            {
              "match": "(?!mapkey\\(continued\\))(.*)",
              "captures": {
                "1": { "name": "markup.bold.mapkey.description" }
              }
            }
          ]
        }
      ]
    },    
    "mapkey-continued": {
      "begin": "^(mapkey\\(continued\\))\\s*~\\s*(\\w+)[\\s\\\\]*",
      "beginCaptures": {
        "1": { "name": "entity.name.function.mapkey.prefix" },
        "2": { "name": "entity.name.function.mapkey.verb" }
      },
      "end": ";",
      "name": "meta.mapkey.continued.command",
      "patterns": [
        {
          "match": "`([^`]*)`",
          "captures": {
            "1": { "name": "string.quoted.other.mapkey.argument" }
          }
        },
        {
          "begin": ";~\\s*(\\w+)",
          "beginCaptures": {
            "1": { "name": "entity.name.function.mapkey.verb" }
          },
          "end": ";",
          "patterns": [
            {
              "match": "`([^`]*)`",
              "captures": {
                "1": { "name": "string.quoted.other.mapkey.argument" }
              }
            }
          ]
        }
      ]
    }
  },

  "patterns": [
    { "include": "#mapkey-init" },
    { "include": "#mapkey-definition" },
    { "include": "#mapkey-continued" }
  ]
}
